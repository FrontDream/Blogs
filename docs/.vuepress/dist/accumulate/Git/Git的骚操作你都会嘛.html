<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Git的骚操作你都会嘛？ | 前端梦想家</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/Blogs/.vuepress/public/index.jpg">
    <meta name="description" content="人生不能没有梦，有梦就要努力！">
    
    <link rel="preload" href="/Blogs/assets/css/0.styles.beb35019.css" as="style"><link rel="preload" href="/Blogs/assets/js/app.0f2b6d44.js" as="script"><link rel="preload" href="/Blogs/assets/js/2.9e84f63c.js" as="script"><link rel="preload" href="/Blogs/assets/js/8.da8f519e.js" as="script"><link rel="prefetch" href="/Blogs/assets/js/10.6b8b7a4d.js"><link rel="prefetch" href="/Blogs/assets/js/11.4539e3f4.js"><link rel="prefetch" href="/Blogs/assets/js/12.a15512ce.js"><link rel="prefetch" href="/Blogs/assets/js/13.74d6830c.js"><link rel="prefetch" href="/Blogs/assets/js/14.db3b5f05.js"><link rel="prefetch" href="/Blogs/assets/js/15.8ae6aab1.js"><link rel="prefetch" href="/Blogs/assets/js/16.2df4dced.js"><link rel="prefetch" href="/Blogs/assets/js/17.1ff1f551.js"><link rel="prefetch" href="/Blogs/assets/js/18.4fc54022.js"><link rel="prefetch" href="/Blogs/assets/js/19.74287a21.js"><link rel="prefetch" href="/Blogs/assets/js/20.d0999c7f.js"><link rel="prefetch" href="/Blogs/assets/js/3.b93f0665.js"><link rel="prefetch" href="/Blogs/assets/js/4.149c4592.js"><link rel="prefetch" href="/Blogs/assets/js/5.8649f992.js"><link rel="prefetch" href="/Blogs/assets/js/6.affc3774.js"><link rel="prefetch" href="/Blogs/assets/js/7.0ff05938.js"><link rel="prefetch" href="/Blogs/assets/js/9.9f3a7625.js">
    <link rel="stylesheet" href="/Blogs/assets/css/0.styles.beb35019.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blogs/" class="home-link router-link-active"><!----> <span class="site-name">前端梦想家</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blogs/accumulate/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/FrontDream" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blogs/accumulate/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/FrontDream" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Blogs/accumulate/" aria-current="page" class="sidebar-link">博客汇总</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微信小程序</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Git</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html" class="active sidebar-link">Git的骚操作你都会嘛？</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#配置用户信息" class="sidebar-link">配置用户信息</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#配置文本编辑器" class="sidebar-link">配置文本编辑器</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#配置命令的别名" class="sidebar-link">配置命令的别名</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#把已有的项目代码纳入到-git-管理" class="sidebar-link">把已有的项目代码纳入到 Git 管理</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#新建的项目-没有代码-直接用-git-管理" class="sidebar-link">新建的项目(没有代码)直接用 Git 管理</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#克隆仓库" class="sidebar-link">克隆仓库</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#添加远程仓库" class="sidebar-link">添加远程仓库</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#head-文件" class="sidebar-link">HEAD 文件</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#config-文件" class="sidebar-link">Config 文件</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#refs-文件" class="sidebar-link">refs 文件</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#objects-文件" class="sidebar-link">objects 文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q1-如何查看工作区、暂存区的状态" class="sidebar-link">Q1: 如何查看工作区、暂存区的状态？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q2-如何查看工作区、暂存区的修改后的差异" class="sidebar-link">Q2: 如何查看工作区、暂存区的修改后的差异？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q3-如何跳过添加到暂存区直接提交" class="sidebar-link">Q3: 如何跳过添加到暂存区直接提交？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q4-如何将连续的多个commit合并成一个" class="sidebar-link">Q4: 如何将连续的多个commit合并成一个？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q5-如何重命名或者移动文件" class="sidebar-link">Q5: 如何重命名或者移动文件？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q6-如何删除指定文件" class="sidebar-link">Q6: 如何删除指定文件？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q7-如何保存文件-当不提交到暂存区" class="sidebar-link">Q7: 如何保存文件，当不提交到暂存区？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q8-如何查看历史提交记录" class="sidebar-link">Q8: 如何查看历史提交记录？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q9-如何修改最近的提交信息" class="sidebar-link">Q9: 如何修改最近的提交信息？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q10-如何修改历史的提交信息尼" class="sidebar-link">Q10: 如何修改历史的提交信息尼？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q11-如何取消暂存中的文件" class="sidebar-link">Q11: 如何取消暂存中的文件？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q12-如何取消工作区中的文件" class="sidebar-link">Q12: 如何取消工作区中的文件？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q13-如何回退到某个-commit" class="sidebar-link">Q13: 如何回退到某个 commit？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q13-如何删除不需要的分支" class="sidebar-link">Q13: 如何删除不需要的分支？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q14-如何查看分支" class="sidebar-link">Q14: 如何查看分支？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q15-如何查看哪些分支已经合并到当前分支" class="sidebar-link">Q15: 如何查看哪些分支已经合并到当前分支？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q16-如何跟远程分支关联" class="sidebar-link">Q16: 如何跟远程分支关联？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q17-如何跟将本地代码推送到远程的某个分支" class="sidebar-link">Q17: 如何跟将本地代码推送到远程的某个分支？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q18-如何获取某个分支的某次提交内容" class="sidebar-link">Q18: 如何获取某个分支的某次提交内容？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q19-pull-与-fetch-有什么区别" class="sidebar-link">Q19: pull 与 fetch 有什么区别？</a></li><li class="sidebar-sub-header"><a href="/Blogs/accumulate/Git/Git的骚操作你都会嘛.html#q20-如何变基" class="sidebar-link">Q20: 如何变基？</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="git的骚操作你都会嘛"><a href="#git的骚操作你都会嘛" class="header-anchor">#</a> Git的骚操作你都会嘛？</h1> <p>正式开始之前先讲个亲身经历经历的故事，在上一个公司工作有个女同事，晚上和男朋友提前说好了约会看电影，快五点了，就想着赶紧提交代码，好下班，可是她<code>push</code>了好几次，都被远端拒绝了，这时候她一狠心一跺脚用了<code>-f</code>，然后就下班去了，她倒是下班了，由于她对之前提交的代码用了<code>rebase</code>，而其他同事又基于她之前的代码开发，直接导致了其他同事的<code>commit id</code>出现了混乱，而导致当天的上线被搁置了，这是一个真实的案例，而其中的问题就在于这个女同事对<code>rebase</code>不熟悉，并采用了危险的<code>git</code>操作。因此，<code>git</code>的操作虽然简单，但在开发过程中却非常重要，如果用不好，自己的工作白费了是轻的，更糟糕的是有可能让自己成为同事厌恶的人。因此<code>git</code>用的好，将会是一个神器，用不好就是噩梦！</p> <h1 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h1> <p>首先问一下自己以下几个问题：</p> <ul><li><p>如何合并几个历史<code>commit</code>?</p></li> <li><p>如何修改历史提交的<code>message</code>?</p></li> <li><p>如何将某个分支的某次<code>commit</code>移到另一个分支尼？</p></li></ul> <p>要是你都会，那恭喜你，可以不用阅读本文了，要是还有疑惑，那就跟着我一起来学习学习吧。</p> <h1 id="一、基本配置"><a href="#一、基本配置" class="header-anchor">#</a> 一、基本配置</h1> <h2 id="配置用户信息"><a href="#配置用户信息" class="header-anchor">#</a> 配置用户信息</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git config <span class="token operator">--</span>global user<span class="token punctuation">.</span>name <span class="token string">&quot;FrontDream&quot;</span>

git config <span class="token operator">--</span>global user<span class="token punctuation">.</span>email <span class="token number">1370336125</span>@qq<span class="token punctuation">.</span>com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>以上配置过程中用到了<code>--global</code>，其实还有<code>--local</code>，<code>--system</code>，下面对此做一个对比，问题不大，可以不用着重考虑。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git config <span class="token operator">--</span>local  <span class="token comment">// local只对某个仓库有效</span>

git config <span class="token operator">--</span>global <span class="token comment">// global对当前用户所有仓库有效</span>

git config <span class="token operator">--</span>system <span class="token comment">// 不常用，对系统所有登陆用户有效</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果想要显示 <code>config</code> 的配置，可以加上<code>--list</code>:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git config <span class="token operator">--</span>list <span class="token operator">--</span>local

git config <span class="token operator">--</span>list <span class="token operator">--</span>global

git config <span class="token operator">--</span>list <span class="token operator">--</span>system
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="配置文本编辑器"><a href="#配置文本编辑器" class="header-anchor">#</a> 配置文本编辑器</h2> <p>当用户信息设置完毕，你可以配置默认文本编辑器了，当 <code>Git</code> 需要你输入信息时会调用它。 如果没有配置，<code>Git</code> 会使用操作系统默认的文本编辑器，通常是 <code>Vim</code>。如果你想使用不同的文本编辑器，例如 <code>Emacs</code>，可以这样做：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git config <span class="token operator">--</span>global core<span class="token punctuation">.</span>editor emacs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="配置命令的别名"><a href="#配置命令的别名" class="header-anchor">#</a> 配置命令的别名</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git config <span class="token operator">--</span>global alias<span class="token punctuation">.</span>ci commit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以通过 <code>git config</code> 文件来轻松地为每一个命令设置一个别名，如上配置后，当要输入 <code>git commit</code> 时，只需要输入 <code>git ci</code>。</p> <h1 id="二、建立仓库"><a href="#二、建立仓库" class="header-anchor">#</a> 二、建立仓库</h1> <p>主要有以下几种场景：</p> <h2 id="把已有的项目代码纳入到-git-管理"><a href="#把已有的项目代码纳入到-git-管理" class="header-anchor">#</a> 把已有的项目代码纳入到 Git 管理</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>$cd 项目代码所在文件夹
$git init
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="新建的项目-没有代码-直接用-git-管理"><a href="#新建的项目-没有代码-直接用-git-管理" class="header-anchor">#</a> 新建的项目(没有代码)直接用 Git 管理</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>$ cd 某个文件夹
$ git init your_project #会在当前路径下创建和项目名称同名的文件夹
$ cd your_project
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="克隆仓库"><a href="#克隆仓库" class="header-anchor">#</a> 克隆仓库</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git clone https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>libgit2<span class="token operator">/</span>libgit2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这会在当前目录下创建一个名为 “<code>libgit2</code>” 的目录，并在这个目录下初始化一个 <code>.git</code> 文件夹， 从远程仓库拉取下所有数据放入 <code>.git</code> 文件夹，然后从中读取最新版本的文件的拷贝。 如果你进入到这个新建的 <code>libgit2</code> 文件夹，你会发现所有的项目文件已经在里面了，准备就绪等待后续的开发和使用。</p> <p>如果你想在克隆远程仓库的时候，自定义本地仓库的名字，你可以通过额外的参数指定新的目录名：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git clone https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>libgit2<span class="token operator">/</span>libgit2 mylibgit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这会执行与上一条命令相同的操作，但目标目录名变为了 <code>mylibgit</code>。</p> <h2 id="添加远程仓库"><a href="#添加远程仓库" class="header-anchor">#</a> 添加远程仓库</h2> <p>当你本地已经有了代码，在 <code>GitHub</code> 上新建了一个仓库，这时候需要将远程的仓库与本地进行合并与关联。</p> <p>首先你需要在仓库中获取到自己的 <code>SSH</code>:</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/ssh.png" alt="ssh"></p> <p>通过命令：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git remote add origin git@github<span class="token punctuation">.</span>com<span class="token operator">:</span>FrontDream<span class="token operator">/</span>FrontDream<span class="token punctuation">.</span>github<span class="token punctuation">.</span>io<span class="token punctuation">.</span>git
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样就将本地的项目与远程的项目进行了关联，如果这时候远程是有文件的如 <code>readme</code> 文件，直接<code>git push --all</code>会失败，这个时候，需要将远程的代码拉下来<code>git fetch</code>，然后再<code>git merge --allow-unrelated-histories origin/master</code>，再<code>git push</code>或者<code>git push -u origin master</code>就好了。</p> <p>如果想要在某个的仓库下配置<code>local</code>的用户名和邮箱，可以在当前仓库的路径下用以下设置：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git config <span class="token operator">--</span>local user<span class="token punctuation">.</span>name <span class="token string">&quot;FrontDream&quot;</span>

git config <span class="token operator">--</span>local user<span class="token punctuation">.</span>email qdw1995@<span class="token number">126.</span>com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这样就达到了只对某个仓库进行配置的目的。如下图所示</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/gitconfig.png" alt="gitconfig"></p> <h1 id="三、深入探索-git-文件"><a href="#三、深入探索-git-文件" class="header-anchor">#</a> 三、深入探索.git 文件</h1> <h2 id="head-文件"><a href="#head-文件" class="header-anchor">#</a> HEAD 文件</h2> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/Head.png" alt="Head"></p> <p>如上图所示，现在 <code>master</code> 分支上，通过<code>cd .git</code>进行<code>git</code>文件，然后通过<code>cat</code>命令将 <code>HEAD</code> 文件的内容输出，然后切换到 <code>204-</code>分支，
再次进入<code>.git</code>文件，并将 <code>HEAD</code> 文件的内容输入。通过对比，我们可以发现，<code>HEAD</code> 文件存放的是当前所在分支的引用。</p> <h2 id="config-文件"><a href="#config-文件" class="header-anchor">#</a> Config 文件</h2> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/config.png" alt="config"></p> <p>如上图所示，通过在<code>.git</code>目录下，通过<code>cat</code>命令将 <code>congig</code> 文件的内容输出，我们可以看到，这个文件存储的就是我们之前配置的用户名和邮箱，我们可以通过文本编辑器打开这个文件，修改用户名和邮箱，这个修改的效果和我们用<code>git config</code> 的命令相同。</p> <h2 id="refs-文件"><a href="#refs-文件" class="header-anchor">#</a> refs 文件</h2> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/refs.png" alt="refs"></p> <p>还记得上面 <code>HEAD</code> 文件中存放的是<code>refs/heads/master</code>嘛？指的就是 <code>refs</code> 文件夹下的 <code>heads</code> 中的 <code>master</code>， 如上图所示，通过在<code>.git</code>目录下，通过<code>cd</code>命令进入 <code>refs</code>，可以看到有 <code>heads</code> 文件夹和 <code>tags</code> 文件夹，继续进入 <code>heads</code>，我们可以看到有很多分支名称的文件，我们通过<code>cat</code>命令输出内容，可以发现，各个分支名的文件存储的其实是 <code>commit</code> 的哈希。可以通过命令<code>git cat-file -t</code> 跟上输出内容的前面一部分查看其是什么类型，输出是<code>commit</code>类型。</p> <p>回到 <code>refs</code> 进入 <code>tags</code>，发现有很多的版本号的名称，我们通过<code>cat</code>输出其中某个版本号文件的内容，同样发现，<code>tag</code> 同样也是某个 commit 的哈希值。但是通过<code>git cat-file -t</code> 跟上输出内容的前面一部分查看其是什么类型，输出是<code>tag</code>类型。继续通过<code>git cat-file -p</code>跟上哈希值(一部分就行)，发现其实他是一个<code>object</code>。不要停，继续通过<code>git cat-file -t</code> 跟上<code>object</code>后面的一部分哈希值，输出了<code>commit</code>类型。这里需要注意的是<code>git cat-file</code>后面跟<code>-t</code>是查看类型，<code>-p</code>是查看内容</p> <p>结论: <code>heads</code>中存放的是各个分支名，而各个分支名其实是<code>commit</code>的哈希值，而<code>tags</code>我们也是在某个 <code>commit</code> 后打的标签，其是通过一个<code>tag</code>类型，其实是一个<code>object</code>对象，包裹着一个<code>commit</code>哈希值。</p> <h2 id="objects-文件"><a href="#objects-文件" class="header-anchor">#</a> objects 文件</h2> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/objects.png" alt="objects"></p> <p>首先从<code>.git</code>目录下进入<code>objects</code>目录，我们发现目录下面有很多两位数的文件夹，进入其中一个如<code>6b</code>，我们发现有很多哈希文件，通过<code>6b</code>，与哈希值进行拼接，并用<code>git cat-file -t</code> 查看类型，发现为<code>tree</code>类型（<code>tree</code>类型是<code>git</code>中重要的类型，其他类型还有<code>commit</code>，<code>blob</code>等）；用<code>git cat-file -p</code>查看内容，我们发现又是一堆哈希，继续用<code>-t</code>查看类型，<code>-p</code>查看内容，我们发现这是我们的新增文件呀，为<code>blob</code>类型。</p> <h1 id="四、基本用法"><a href="#四、基本用法" class="header-anchor">#</a> 四、基本用法</h1> <p>我们将在此部分中用提问的方式，引出每一条命令。</p> <h3 id="q1-如何查看工作区、暂存区的状态"><a href="#q1-如何查看工作区、暂存区的状态" class="header-anchor">#</a> Q1: 如何查看工作区、暂存区的状态？</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git status
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>命令的输出十分详细，但其用语有些繁琐。 <code>Git</code> 有一个选项可以帮你缩短状态命令的输出，这样可以以简洁的方式查看更改。 如果你使用 <code>git status -s</code> 命令或 <code>git status --short</code> 命令，你将得到一种格式更为紧凑的输出。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git status <span class="token operator">-</span>s
<span class="token constant">M</span> <span class="token constant">README</span>
<span class="token constant">MM</span> Rakefile
<span class="token constant">A</span> lib<span class="token operator">/</span>git<span class="token punctuation">.</span>rb
<span class="token constant">M</span> lib<span class="token operator">/</span>simplegit<span class="token punctuation">.</span>rb
<span class="token operator">??</span> <span class="token constant">LICENSE</span><span class="token punctuation">.</span>txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>新添加的未跟踪文件前面有 <code>??</code> 标记，新添加到暂存区中的文件前面有<code>A</code> 标记，修改过的文件前面有 <code>M</code> 标记。 输出中有两栏，左栏指明了暂存区的状态，右栏指明了工作区的状态。例如，上面的状态报告显示： <code>README</code> 文件在工作区已修改但尚未暂存，而 <code>lib/simplegit.rb</code> 文件已修改且已暂存。 <code>Rakefile</code> 文件已修，暂存后又作了修改，因此该文件的修改中既有已暂存的部分，又有未暂存的部分。</p> <h3 id="q2-如何查看工作区、暂存区的修改后的差异"><a href="#q2-如何查看工作区、暂存区的修改后的差异" class="header-anchor">#</a> Q2: 如何查看工作区、暂存区的修改后的差异？</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git diff
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此比较的是工作目录中当前文件和暂存区域快照之间的差异。 也就是修改之后还没有暂存起来的变化内容。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git diff <span class="token operator">--</span>staged
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这条命令将比对已暂存文件与最后一次提交的文件差异。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git diff 分支一 分支二 <span class="token operator">--</span> 要比较的文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此命令对两个分支的某个文件进行比较差异。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git diff #hash1 #hash2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此命令对比 <code>commit1</code> 和 <code>commit2</code> 的差异。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git diff <span class="token constant">HEAD</span> <span class="token constant">HEAD</span><span class="token operator">~</span><span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>对比 <code>HEAD</code>（其实指向的也是一个<code>commit</code>的哈希）与 <code>HEAD</code> 的父亲的父亲（上两次 <code>commit</code>）的差异。</p> <h3 id="q3-如何跳过添加到暂存区直接提交"><a href="#q3-如何跳过添加到暂存区直接提交" class="header-anchor">#</a> Q3: 如何跳过添加到暂存区直接提交？</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git commit <span class="token operator">-</span>a <span class="token operator">-</span>m <span class="token string">'added new benchmarks'</span>
git commit <span class="token operator">-</span>am <span class="token string">'added new benchmarks'</span>  <span class="token comment">// 简化版</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>此命令将跳过使用暂存区域，尽管使用暂存区域的方式可以精心准备要提交的细节，但有时候这么做略显繁琐。 Git 提供了一个跳过使用暂存区域的方式， 只要在提交的时候，给 <code>git commit</code> 加上 <code>-a</code> 选项，<code>Git</code> 就会自动把所有已经跟踪过的文件暂存起来一并提交，从而跳过 <code>git add</code> 步骤。</p> <h3 id="q4-如何将连续的多个commit合并成一个"><a href="#q4-如何将连续的多个commit合并成一个" class="header-anchor">#</a> Q4: 如何将连续的多个<code>commit</code>合并成一个？</h3> <p>以下图为例，需要将前三个<code>commit</code>合并成一个，首先复制第三个<code>commit</code>后面的哈希值。</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/merge1.png" alt="merge1"></p> <p>然后运行命令：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git rebase <span class="token operator">-</span>i #复制的哈希
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>出现如下界面：</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/merge2.png" alt="merge2"></p> <p>将第二、第三的<code>pick</code>修改为<code>s</code>（squash 简写），如下图所示，保存按<code>esc</code>，输入<code>:wq!</code>保存退出。</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/merge3.png" alt="merge3"></p> <p>继续出现如下界面：</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/merge4.png" alt="merge4"></p> <p>添加一条<code>message</code>，如下图所示：</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/merge5.png" alt="merge5"></p> <p>保存按<code>esc</code>输入<code>:wq!</code>退出。成功界面如下图所示：</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/merge6.png" alt="merge6"></p> <p><code>squash</code>是指将该<code>commit</code>合并到相邻的<code>pick</code>的<code>commit</code>中。</p> <h3 id="q5-如何重命名或者移动文件"><a href="#q5-如何重命名或者移动文件" class="header-anchor">#</a> Q5: 如何重命名或者移动文件？</h3> <p>重命名文件或者移动文件。如果是移动根目录下的文件，要有相对路径。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git mv file_from file_to
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="q6-如何删除指定文件"><a href="#q6-如何删除指定文件" class="header-anchor">#</a> Q6: 如何删除指定文件？</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git rm 待删除文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="q7-如何保存文件-当不提交到暂存区"><a href="#q7-如何保存文件-当不提交到暂存区" class="header-anchor">#</a> Q7: 如何保存文件，当不提交到暂存区？</h3> <p>这个问题可以用一个场景来解释，如果在开发过程中，工作区已经有了修改内容，这时需要立马修复一个 <code>bug</code>，这时是不可能直接跳到某个分支去修改的，我们需要先提交到暂存区，但是我其实不满意与现在的修改，后面还需要再大改，我不想提交到暂存区。这时就可以通过命令：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git stash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此命令将工作区的内容存放在堆栈中，当我们修改好了 <code>bug</code>，就重新用：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git stash apply
or
git stash pop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>恢复工作区的内容，需要注意的是，<code>apply</code>会在堆栈中保存原有的<code>stash</code>信息，而<code>pop</code>将会把<code>stash</code>中的内容清空。</p> <h3 id="q8-如何查看历史提交记录"><a href="#q8-如何查看历史提交记录" class="header-anchor">#</a> Q8: 如何查看历史提交记录？</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我相信小孩都知道，在不传入任何参数的默认情况下，<code>git log</code> 会按时间先后顺序列出所有的提交，最近的更新排在最上面。</p> <p>其中一个比较有用的选项是 <code>-p</code> 或 <code>--patch</code> ，它会显示每次提交所引入的差异（按 补丁 的格式输出）。 你也可以限制显示的日志条目数量，例如使用 <code>-2</code> 选项来只显示最近的两次提交。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git log <span class="token operator">-</span>p <span class="token operator">-</span><span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果我希望在一行显示需要的信息，可以进行相应的配置如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git log <span class="token operator">--</span>pretty<span class="token operator">=</span>oneline
git log <span class="token operator">--</span>oneline <span class="token comment">//简化版</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>oneline</code> 会将每个提交放在一行显示，在浏览大量的提交时非常有用。 另外还有 <code>short</code>，<code>full</code> 和 <code>fuller</code> 选项，它们展示信息的格式基本一致，但是详尽程度不一。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git log <span class="token operator">--</span>pretty<span class="token operator">=</span>format<span class="token operator">:</span><span class="token string">&quot;%h - %an, %ar : %s&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以定制记录的显示格式:</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/format.png" alt="format"></p> <p>当 <code>oneline</code> 或 <code>format</code> 与另一个 <code>log</code> 选项 <code>--graph</code> 结合使用时尤其有用。 这个选项添加了一些 <code>ASCII</code> 字符串来形象地展示你的分支、合并历史。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git log <span class="token operator">--</span>pretty<span class="token operator">=</span>format<span class="token operator">:</span><span class="token string">&quot;%h %s&quot;</span> <span class="token operator">--</span>graph
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>限制输出长度</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/limit.png" alt="limit"></p> <p>示例如下：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>$ git log <span class="token operator">--</span>pretty<span class="token operator">=</span><span class="token string">&quot;%h - %s&quot;</span> <span class="token operator">--</span>author<span class="token operator">=</span><span class="token string">'Junio C Hamano'</span> <span class="token operator">--</span>since<span class="token operator">=</span><span class="token string">&quot;2008-10-01&quot;</span> \
   <span class="token operator">--</span>before<span class="token operator">=</span><span class="token string">&quot;2008-11-01&quot;</span> <span class="token operator">--</span>no<span class="token operator">-</span>merges <span class="token operator">--</span> t<span class="token operator">/</span>
<span class="token number">5610e3</span>b <span class="token operator">-</span> Fix testcase failure when extended attributes are <span class="token keyword">in</span> use
acd3b9e <span class="token operator">-</span> Enhance hold_lock_file_for_<span class="token punctuation">{</span>update<span class="token punctuation">,</span>append<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token constant">API</span>
f563754 <span class="token operator">-</span> demonstrate breakage <span class="token keyword">of</span> detached checkout <span class="token keyword">with</span> symbolic link <span class="token constant">HEAD</span>
d1a43f2 <span class="token operator">-</span> reset <span class="token operator">--</span>hard<span class="token operator">/</span>read<span class="token operator">-</span>tree <span class="token operator">--</span>reset <span class="token operator">-</span>u<span class="token operator">:</span> remove unmerged <span class="token keyword">new</span> <span class="token class-name">paths</span>
<span class="token number">51</span>a94af <span class="token operator">-</span> Fix <span class="token string">&quot;checkout --track -b newbranch&quot;</span> on detached <span class="token constant">HEAD</span>
b0ad11e <span class="token operator">-</span> pull<span class="token operator">:</span> allow <span class="token string">&quot;git pull origin $something:\$current_branch&quot;</span> into an unborn branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>以上是通过命令行<code>git log</code>查看版本历史信息，当然也可以通过<code>gitk</code>命令调出图形化界面，查看历史信息。在命令行中输入<code>gitk</code>，调出如下界面：</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/tablelayout.png" alt="limit"></p> <h3 id="q9-如何修改最近的提交信息"><a href="#q9-如何修改最近的提交信息" class="header-anchor">#</a> Q9: 如何修改最近的提交信息？</h3> <p>有时候我们提交完了才发现漏掉了几个文件没有添加，或者说上一次的提交信息写错了，我们想修改当前分支最近的 <code>commit</code> 的 <code>message</code>。 此时，可以运行带有 <code>--amend</code> 选项的提交命令来重新提交，第二次的提交会替代掉第一次的提交。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>$ git commit <span class="token operator">-</span>m <span class="token string">'initial commit'</span>
$ git add forgotten_file
$ git commit <span class="token operator">--</span>amend
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>两次提交只有一次提交信息。</p> <h3 id="q10-如何修改历史的提交信息尼"><a href="#q10-如何修改历史的提交信息尼" class="header-anchor">#</a> Q10: 如何修改历史的提交信息尼？</h3> <p>这里需要用到<code>rebase</code>了。如下图，我们想修改历史的提交信息“ant4.0 升级”为“升级 ant4.0”。</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/modifyHistoryMessage1.png" alt="modifyHistoryMessage1"></p> <p>首先需要找到需要修改的提交信息的上一个（父级）的哈希值，记住是<strong>需要修改的上一次提交的哈希值</strong>，并复制，重要的事情说三遍！</p> <p>然后通过命令：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git rebase <span class="token operator">-</span>i #你复制的哈希值
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后将出现如下界面：</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/modify.png" alt="modify"></p> <p>如下图所示，修改你需要修改的提交信息前面的<code>pick</code>为<code>r</code>（reward 的简写），保存，然后点击一下<code>esc</code>，输入<code>:wq!</code>回车退出。</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/modifyHistoryMessage2.png" alt="modifyHistoryMessage2"></p> <p>接着出现如下界面，供你修改提交信息。</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/modify2.png" alt="modify2"></p> <p>编辑修改，并保存，在英文输入法下点击一下<code>esc</code>，输入<code>:wq!</code>回车退出。出现如下界面，即成功修改了历史的提交信息。</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/modifyHistoryMessage3.png" alt="modifyHistoryMessage3"></p> <h3 id="q11-如何取消暂存中的文件"><a href="#q11-如何取消暂存中的文件" class="header-anchor">#</a> Q11: 如何取消暂存中的文件？</h3> <p>可以通过如下命令实现取消暂存中的文件：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git reset <span class="token constant">HEAD</span> <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="q12-如何取消工作区中的文件"><a href="#q12-如何取消工作区中的文件" class="header-anchor">#</a> Q12: 如何取消工作区中的文件？</h3> <p>如果我们现在正在工作区中工作，发现现在的写法还不如已经提交的写法，想把还没添加到暂存区的文件取消修改，可以通过如下命令：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git checkout <span class="token operator">--</span> <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="q13-如何回退到某个-commit"><a href="#q13-如何回退到某个-commit" class="header-anchor">#</a> Q13: 如何回退到某个 commit？</h3> <p>有时候我们提交了一些改动，后来又不想要了。有可能是<code>WIP</code>提交，也可能是某个引入了 <code>bug</code> 的提交。这种情况，我们可以执行<code>git reset</code>。<code>git reset</code>会丢弃当前所有暂存的文件，并让我们决定 HEAD 应该指向哪里。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git reset <span class="token operator">--</span>soft #哈希
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>soft reset</code> 将<code>HEAD</code> 移动到指定的提交（或者相对于<code>HEAD</code> 的位置索引），同时不会丢弃这些提交带来的改动。执行<code>git status</code>，你会看到我们依然能够查看之前提交所做的改动。这很有用，因为这样我们就能继续修改文件内容，后续再次提交了。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git reset <span class="token operator">--</span>hard #哈希
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>有时候，我们不想保留某些提交带来的改动。跟 <code>soft reset</code> 不一样，我们不再需要访问这些变动了。<code>Git</code> 应该简单地重置到指定的提交，并且会重置工作区和暂存区的文件。</p> <h3 id="q13-如何删除不需要的分支"><a href="#q13-如何删除不需要的分支" class="header-anchor">#</a> Q13: 如何删除不需要的分支？</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git branch <span class="token operator">-</span>d you<span class="token operator">-</span>branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="q14-如何查看分支"><a href="#q14-如何查看分支" class="header-anchor">#</a> Q14: 如何查看分支？</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git branch <span class="token operator">-</span>v
or
git branch <span class="token operator">-</span>av
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>-v</code>表示的是查看本地有哪些分支，而<code>-av</code>查看的是本地和远程的分支。</p> <p>还有一种情况是为了查看设置的所有跟踪分支可以用<code>-vv</code>。将所有的本地分支列出来并且包含更多的信息，如每一个分支正在跟踪哪个远程分支与本地分支是否是领先、落后或是都有。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git branch <span class="token operator">-</span>vv
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="q15-如何查看哪些分支已经合并到当前分支"><a href="#q15-如何查看哪些分支已经合并到当前分支" class="header-anchor">#</a> Q15: 如何查看哪些分支已经合并到当前分支？</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git branch <span class="token operator">--</span>merged
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git branch <span class="token operator">--</span>no<span class="token operator">-</span>merged
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>--merged</code>查看有哪些分支已经合并到当前分支，而<code>--no-merged</code>查看所有包含未合并工作的分支，因为它包含了还未合并的工作，尝试使用 <code>git branch -d</code> 命令删除它时会失败（可以使用 <code>-D</code> 选项强制删除它）。</p> <h3 id="q16-如何跟远程分支关联"><a href="#q16-如何跟远程分支关联" class="header-anchor">#</a> Q16: 如何跟远程分支关联？</h3> <p>如果远程已经有了<code>feature-branch</code>，通过<code>git fetch</code>拉到本地，并通过以下命令在本地新建了<code>feature-branch</code>，并同远程分支关联。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git checkout <span class="token operator">-</span>b feature<span class="token operator">-</span>branch origin<span class="token operator">/</span>feature<span class="token operator">-</span>branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="q17-如何跟将本地代码推送到远程的某个分支"><a href="#q17-如何跟将本地代码推送到远程的某个分支" class="header-anchor">#</a> Q17: 如何跟将本地代码推送到远程的某个分支？</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git push origin local<span class="token operator">-</span>branch<span class="token operator">:</span>feature<span class="token operator">-</span>branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>推送本地的 <code>local-branch</code>(冒号前面的)分支到远程 <code>origin</code> 的 <code>feature-branch</code>(冒号后面的)分支(没有会自动创建)</p> <p>下一次其他协作者从服务器上抓取数据时，他们会在本地生成一个远程分支 <code>origin/feature-branch</code>，指向服务器的 <code>feature-branch</code> 分支的引用。本地不会自动生成一份可编辑的副本（拷贝）。 换一句话说，这种情况下，不会有一个新的 <code>feature-branch</code> 分支，只有一个不可以修改的 <code>origin/feature-branch</code> 指针。</p> <p>可以运行 <strong>git merge origin/feature-branch</strong> 将这些工作合并到当前所在的分支。</p> <p>如果想要在自己的 <code>my_branch</code> 分支上工作，可以将其建立在远程跟踪分支之上：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git checkout <span class="token operator">-</span>b my_branch origin<span class="token operator">/</span>feature<span class="token operator">-</span>branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样就新开了一个本地分支 <code>my_branch</code> 用户跟踪远程的 <code>feature-branch</code>。看起来是挺复杂的，但是可以简化：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git checkout <span class="token operator">--</span>track origin<span class="token operator">/</span>feature<span class="token operator">-</span>branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样的本地的 <code>feature-branch</code> 分支就可以跟踪远程的 <code>feature-branch</code> 分支了。还可以继续简化：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git checkout feature<span class="token operator">-</span>branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>当然简化的化就无法重命名了，如果需要重命名还是得使用：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git checkout <span class="token operator">-</span>b my_branch origin<span class="token operator">/</span>feature<span class="token operator">-</span>branch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="q18-如何获取某个分支的某次提交内容"><a href="#q18-如何获取某个分支的某次提交内容" class="header-anchor">#</a> Q18: 如何获取某个分支的某次提交内容？</h3> <p>当活动分支需要某个分支的某个提交包含的改动时，我们可以用<code>cherry-pick</code>命令。通过<code>cherry-pick</code>某个提交，在当前活动分支上会创建一个新提交，包含了前者带来的改动。</p> <p>如下图所示（盗来的），假设 <code>dev</code> 分支上的提交<code>76d12</code>改动了<code>index.js</code>文件，我们在<code>master</code>分支上也需要。我们不需要整个分支上的改动，只要这个提交。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git cherry<span class="token operator">-</span>pick <span class="token number">76</span>d12
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/chery-pick.gif" alt="chery-pick"></p> <h3 id="q19-pull-与-fetch-有什么区别"><a href="#q19-pull-与-fetch-有什么区别" class="header-anchor">#</a> Q19: pull 与 fetch 有什么区别？</h3> <p>用 <code>git fetch</code> 把这些改动获取到本地。这不会影响本地分支，<code>fetch</code>只是下载数据。<code>git pull</code>实际上是两个命令合而为一：<code>git fetch</code>和<code>git merge</code>。当我们从 <code>origin</code> 拉取改动时，先是像<code>git fetch</code>一样获取所有数据，然后最新改动会自动合并到本地分支。</p> <h3 id="q20-如何变基"><a href="#q20-如何变基" class="header-anchor">#</a> Q20: 如何变基？</h3> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/basic-rebase-1.png" alt="basic-rebase-1"></p> <p>如上图所示，我们从<code>C2</code>拉出了特性分支<code>experiment</code>并进行了开发到<code>C4</code>，同时<code>master</code>继续开发到<code>C3</code>，现在我们需要将<code>C3</code>，与<code>C4</code>进行合并，通过<code>git merge</code>是其中一种策略：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git checkout master

git merge experiment
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/basic-rebase-2.png" alt="basic-rebase-2"></p> <p>另外一种策略就是通过变基：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git checkout experiment

git rebase master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/basic-rebase-3.png" alt="basic-rebase-3"></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>git checkout master

git merge experiment
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/basic-rebase-4.png" alt="limit"></p> <p>这两种整合方法的最终结果都是将<code>C3</code>和<code>C4</code>进行合并到主分支，结果没有任何区别，主要是历史记录的区别，<code>rebase</code>是一种直线型的，提交历史非常清晰整洁，而<code>merge</code>相对来说分支比较复杂。</p> <p>尽管变基会使得我们的提交历史变得更加简洁，但是变基是有风险的，但是当<code>rebase</code>出现冲突时，处理过程比较麻烦，同时当对已经<code>push</code>到远端，同事也基于你的<code>push</code>进行开发，然后你又对之前的<code>push</code>执行变基操作，就会出问题，本文开始的故事就是真实的案例。总的原则是，<strong>只对尚未推送或分享给别人的本地修改执行变基操作清理历史， 从不对已推送至别处的提交执行变基操作</strong>。</p> <h1 id="github"><a href="#github" class="header-anchor">#</a> GitHub</h1> <p>GitHub 搜索，如何才能搜出匹配度高，stars 数多的项目呢？可以试试下面这个方式：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>关键字一 关键字二 <span class="token keyword">in</span><span class="token operator">:</span>readme stars<span class="token operator">:</span><span class="token operator">&gt;</span><span class="token number">1000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/search1.png" alt="search"></p> <p>然后我们在点击下面的<code>repositories</code>或者<code>code</code>进一步的寻找符合的项目。</p> <p><img src="/Git/Git%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C%E4%BD%A0%E9%83%BD%E4%BC%9A%E5%98%9B/search.png" alt="search"></p> <p>我们可以点击下面的<code>Advanced search</code>做到更加高级的搜索。</p> <h1 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h1> <p><code>git</code>操作总的来说并不是很难，难点在于对命令的理解和记住，好好掌握，让<code>git</code>成为我们的利器而不是我们的噩梦！</p> <p><img src="https://github.com/FrontDream/FrontDream.github.io/blob/master/assets/image/personal/qrcode.png?raw=true" alt=""></p> <p>❤️ 爱心三连击</p> <p>1.看到这里了就点个在看支持下吧，你的「在看」是我创作的动力。</p> <p>2.关注公众号前端梦想家，「一起学前端」！</p> <p>3.添加微信【qdw1370336125】，拉你进技术交流群一起学习。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/10/2021, 6:31:18 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Blogs/accumulate/微信小程序/微信小程序组件height高度自适应.html" class="prev">
        微信小程序组件height高度自适应
      </a></span> <span class="next"><a href="/Blogs/accumulate/React/AntDesignPro中台项目迁移Typescript，并接入Eslint+Prettier代码格式化.html">
        AntDesignPro中台项目迁移Typescript，并接入Eslint+Prettier代码格式化
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Blogs/assets/js/app.0f2b6d44.js" defer></script><script src="/Blogs/assets/js/2.9e84f63c.js" defer></script><script src="/Blogs/assets/js/8.da8f519e.js" defer></script>
  </body>
</html>
